# Sleep 함수와 우연

<br>

* Sleep 함수가 무엇인가?
* Sleep 함수가 만들어 내는 우연, 그리고 위험성
  
## 1. Thread

쓰레드란 기본적으로 실행의 단위다. 예를 들어 4코어 CPU가 있고 코어 하나당 처리 가능한 쓰레드가 2개라면 총 8개의 쓰레드가 처리 가능(하이퍼 쓰레드는 예외)하다.

<br>

![alt text](<./image/Screenshot 2024-07-04 at 7.36.50 PM.png>)

<br>

프로세스는 여러 개의 쓰레드를 가질 수 있다. 쓰레드는 프로세스와 마찬가지로 항상 **상태**라는 개념을 가지고 있다. 기본적으로 CPU가 쓰레드를 실행하고 있다면 해당 쓰레드의 상태는 `Running`이 된다. 이 쓰레드를 잠시 멈출 경우 상태는 `Suspend`가 된다. OS는 쓰레드의 상태를 바탕으로 쓰레드를 관리하고, 상태가 변경되는 상황을 **상태 전환**이라고 한다.

<br>

## 2. Sleep 함수가 만들어 내는 우연 

<br>

![alt text](<./image/Screenshot 2024-07-04 at 7.37.59 PM.png>)

<br>

`Running` 상태의 스레드가 `Suspend`로 상태 전환하기 위해서 **호출하는 함수가 Sleep 함수**이다. `Sleep()` 함수는 매개변수로 `ms`를 받는다. Sleep 함수를 호출하게 되면 CPU에 있던 본인의 자리를 반납하게 된다. 즉, 단순히 쓰레드의 실행을 쉰다는 의미가 아니라 쓰레드가 쓰레드 스케줄러에서 제외된다는 의미다.

<br>

예를 들어 `Sleep(1ms)`를 하게 되면 1ms의 시간동안 쓰레드 스케줄러에서 제외되어 `suspend` 상태가 된다는 것이기 때문에 실제로 실행이 되지 않는 시간은 `1ms + a`가 된다. 이 `a`에 해당하는 시간은 당시 실행 중일 OS마다 다르고 프로세스 상태마다 다르기 때문에 1ms라는 시간은 부정확하며 `a`라는 시간은 **우연적**이라는 것이다.

<br>

## Reference

* [널널한 개발자 TV](https://www.youtube.com/watch?v=Js1HSwUurpw&list=PLXvgR_grOs1DGFOeD792kHlRml0PhCe9l&index=2)